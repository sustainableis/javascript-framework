!function(a,b){a.module("sis",["ngResource","oc.lazyLoad"]),a.module("sis.api",["sis"]),a.module("sis.modules",["sis"]),a.module("sis.api").value("sisToken",{}),a.module("sis.api").factory("authInterceptor",["$q","sisToken","sisApi",function(a,c,d){return{request:function(a){var e=!1;return a.headers=a.headers||{},b.has(a,"data")&&b.isObject(a.data)&&!b.isArray(a.data)&&(a.data=$.param(a.data)),b.each(d.services,function(b){a.url.indexOf(b.url)>-1&&(e=!0)}),a.url.indexOf(d.url)>-1&&(e=!0),c.access_token&&e&&(a.headers.Authorization="Bearer "+c.access_token),a},response:function(b){return 503===b.status,b||a.when(b)}}}]),a.module("sis.api").config(["$httpProvider",function(a){a.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded",a.defaults.headers.put["Content-Type"]="application/x-www-form-urlencoded",a.interceptors.push("authInterceptor")}]),a.module("sis.modules").config(["$sceDelegateProvider","$compileProvider","$filterProvider","$ocLazyLoadProvider","$logProvider","sisModulesProvider",function(c,d,e,f,g,h){g.debugEnabled(!1),setTimeout(function(){c.resourceUrlWhitelist(["self",h.path+"/**"])}),f.config({debug:!1,events:!0}),a.module("sis.modules")._filter=function(a,b){e.register(a,b)},a.module("sis.modules")._directive=function(c,e){d.directive(c,["$injector","$ocLazyLoad",function(c,d){var f=e(c,d),g={restrict:"E",templateUrl:function(b,c){var d=a.element(b).prop("tagName").toLowerCase();return h.path+"/dist/"+d+"/"+c.version+"/"+d+".min.html"},scope:{id:"@id",version:"@version"}};return b.extend(g,f)}])}}])}(window.angular,window._),function(a){a.module("sis.api").factory("AlertsService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/alerts/:id/:controller/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"},trigger:{method:"POST",isArray:!0}})}])}(window.angular),function(a){a.module("sis.api").provider("sisApi",function(){this.url="http://api.sustainableis.com/",this.version="v1",this.services={},this.$get=function(){return{url:this.url,version:this.version,services:this.services}}})}(window.angular),function(a){a.module("sis.api").factory("AreasService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/areas/:id/:controller/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("BatchService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/batch",{},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("BuildingsService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/buildings/:id/:controller/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("ConfigurationsService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/configurations/:id/:controller/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"}})}])}(window.angular),function(a,b){a.module("sis.modules").provider("dataStore",function(){this.cache={},this.expires=300,this.$get=["$injector","$log","OauthService","FacilitiesService","OrganizationsService","BuildingsService","FeedsService","OutputsService","UsersService","WeatherService",function(a,c,d,e,f,g,h,i,j,k){var l=this,m=0,n=1,o=2,p=3,q=function(a){var c={},d=a.split("/");return b.each(d,function(a){var b=a.split(":"),d=b[0],e=b[1];"@service"===d&&(c.is__object=!0,d="service"),c[d]=e}),c},r=function(d,e,f,g){var h=q(e),i=h.service.charAt(0).toUpperCase()+h.service.slice(1)+"Service",j=a.get(i),k=b.omit(h,["service","is__object"]);switch(d){case m:b.has(h,"is__object")?j.get(k,function(a){g(a)},function(a){c.error(a),g(null,a)}):j.query(k,function(a){g(a)},function(a){c.error(a),g(null,a)});break;case n:j.save(k,f,function(a){g(a)},function(a){c.error(a),g(null,a)});break;case o:if(!b.has(j,"update"))return g(null,i+"has not method update");j.update(k,f,function(a){g(a)},function(a){c.error(a),g(null,a)});break;case p:j["delete"](k,function(a){g(a)},function(a){c.error(a),g(null,a)});break;default:g(null,"Invalid method",d,"for calling",e)}},s=function(a,d,e){if(e=!1,b.has(l.cache,a)&&e===!0){if(moment().diff(l.cache[a].added,"seconds")<l.expires)return c.debug("Returned",l.cache[a].data,"from cache","for topic",a),d(l.cache[a].data);c.debug("Hit missed to cache for topic",a)}r(m,a,null,function(b,e){c.debug("Returned",b,"from API","for topic",a),l.cache[a]={data:b,added:moment()},d(b,e)})},t=function(a,b,d){r(n,a,b,function(b,e){c.debug("Returned",b,"from API","for topic",a),d(b,e)})},u=function(a,b,d){r(o,a,b,function(b,e){c.debug("Returned",b,"from API","for topic",a),d(b,e)})},v=function(a,b){r(p,a,function(d,e){c.debug("Returned",d,"from API","for topic",a),b(d,e)})};return{get:s,post:t,put:u,"delete":v}}]})}(window.angular,window._),function(a){a.module("sis.api").factory("EmailsService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/emails/:id/:controller/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"},trigger:{method:"POST",isArray:!0}})}])}(window.angular),function(){var a={},b=function(b,c){a.hasOwnProperty(b)||(a[b]=[]);var d=a[b].push(c)-1;return{remove:function(){delete a[b][d]}}},c=function(b,c){if(a.hasOwnProperty(b)){var d=c||{};a[b].forEach(function(a){a(d)})}},d=function(){a={}};window.events={subscribe:b,publish:c,purge:d,topics:a}}(),function(a){a.module("sis.api").factory("FacilitiesService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/facilities/:id/:controller/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("FeedsService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/feeds/:id/:controller/:verb",{id:"@id",controller:"@controller",verb:"@verb"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("FieldsService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/fields/:id/:controller/:metric_name/:verb",{id:"@id",controller:"@controller",metric_name:"@metric_name",verb:"@verb"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("FilesService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/files/:id/:verb",{id:"@id",verb:"@verb"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("GroupsService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/groups/:id/:controller/:verb",{id:"@id",controller:"@controller",verb:"@verb"})}])}(window.angular),function(a){a.module("sis.api").factory("MandrillService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/mandrill/:id/:controller/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"}})}])}(window.angular),function(a,b,c,d){a.module("sis.modules").provider("sisModules",function(){this.path=null,this.$get=["$injector","$q","$log","$rootScope","$compile","$timeout","$ocLazyLoad","dataStore",function(d,e,f,g,h,i,j,k){var l=this,m=!1,n=function(){m||(m=!0,b.subscribe("get",function(a){f.debug("Framework got",a,"on","get"),k.get(a.topic,function(c,d){f.debug("Framework sent",c,"on",a.caller),b.publish(a.caller,{data:c,error:d})},a.cache)}),b.subscribe("post",function(a){f.debug("Framework got",a,"on","post"),k.post(a.topic,a.payload,function(c,d){f.debug("Framework sent",c,"on",a.caller),b.publish(a.caller,{data:c,error:d})})}),b.subscribe("put",function(a){f.debug("Framework got",a,"on","post"),k.put(a.topic,a.payload,function(c,d){f.debug("Framework sent",c,"on",a.caller),b.publish(a.caller,{data:c,error:d})})}),b.subscribe("delete",function(a){f.debug("Framework got",a,"on","post"),k["delete"](a.topic,function(c,d){f.debug("Framework sent",c,"on",a.caller),b.publish(a.caller,{data:c,error:d})})}))},o=function(a){k.get("service:modules/id:"+a+"/controller:channels",function(d,e){e||c.each(d,function(c){k.get(c.topic,function(d,e){f.debug("Framework sent",d,"on",a+":"+c.route),b.publish(a+":"+c.route,{data:d,error:e})})})})},p=function(b,d){var i=[],k=[],m=d||{},p=m.scope||g.$new(!0);i=c.has(m,"container")?a.element(m.container+" .module"):a.element(".module"),n(),c.each(i,function(b){var c=a.element(b).data("id"),d=a.element(b).data("version"),e=a.element(b).prop("tagName").toLowerCase(),i=l.path+"/dist/"+e+"/"+d+"/"+e+".min",m=j.load({serie:!0,files:[i+".css",i+".html",i+".js"]}).then(function(){o(c)},function(){f.error("Module",e,":",c,"@",d,"is missing files")});k.push(m),g.$on("ocLazyLoad.fileLoaded",function(a,c){c===i+".js"&&h(b)(p)})}),e.all(k).then(b)},q=function(){};return{init:p,destroy:q,path:this.path}}]})}(window.angular,window.events,window._,window.$),function(a){a.module("sis.api").factory("ModulesService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/modules/:id/:controller/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("OauthService",["$resource","sisApi",function(a,b){return a(b.url+"oauth/:controller",{controller:"@controller"})}])}(window.angular),function(a){a.module("sis.api").factory("OrganizationsService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/organizations/:id/:controller/:verb",{id:"@id",controller:"@controller",verb:"@verb"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("OutputsService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/outputs/:id/:controller/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("RatesService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/rates/:controller/:id/:verb/:second_id/:action",{controller:"@controller",id:"@id",verb:"@verb",second_id:"@second_id",action:"@action"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("ReportsService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/reporting/:id/:controller/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"},trigger:{method:"POST",isArray:!0}})}])}(window.angular),function(a){a.module("sis.api").factory("StacksService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/stacks/:id/:controller/:verb",{id:"@id",controller:"@controller",verb:"@verb"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("TextsService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/texts/:id/:controller/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"},trigger:{method:"POST",isArray:!0}})}])}(window.angular),function(a){a.module("sis.api").factory("UsersService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/users/:id/:controller/:verb",{id:"@id",controller:"@controller",verb:"@verb"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("UtilitiesService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/utilities/:controller/:id/:verb/:verb_id",{controller:"@controller",id:"@id",verb:"@verb",verb_id:"@verb_id"},{update:{method:"PUT"}})}])}(window.angular),function(a,b,c,d){a.module("sis.modules").provider("sisViews",function(){this.$get=["$log","$compile","$ocLazyLoad","$q","$rootScope","dataStore","sisModules",function(b,e,f,g,h,i,j){var k=function(k,l){var m=a.element(".__view__"),n=[],o=l||{},p=o.scope||h.$new(!0);c.each(m,function(k){var l=a.element(k).data("id"),m=a.element(k).data("version"),o=a.element(k).prop("tagName").toLowerCase(),q=j.path+"/dist/"+o+"/"+m+"/"+o+".min",r=g.defer();f.load({serie:!0,files:[q+".css",q+".html",q+".js"]}).then(function(){i.get("service:views/id:"+l+"/controller:modules",function(b,f){var g=d(o+" .placeholder");c.each(g,function(d){var f=c.findWhere(b,{placeholder:d.id});if(f){var g="<"+f.slug+' class="module" data-id="'+f.id+'" data-version="'+f.version+'">';module_element=e(g)(p),a.element(d).empty(),a.element(d).append(module_element)}}),r.resolve()})},function(){b.error("Module",o,":",l,"@",m,"is missing files")}),h.$on("ocLazyLoad.fileLoaded",function(a,b){b===q+".js"&&e(k)(p)}),n.push(r.promise)}),g.all(n).then(k)};return{init:k}}]})}(window.angular,window.events,window._,window.$),function(a){a.module("sis.api").factory("ViewsService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/views/:id/:controller/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"}})}])}(window.angular),function(a){a.module("sis.api").factory("WeatherService",["$resource","sisApi",function(a,b){return a(b.url+b.version+"/weather/:controller/:id/:verb/:action",{id:"@id",controller:"@controller",verb:"@verb",action:"@action"},{update:{method:"PUT"}})}])}(window.angular);